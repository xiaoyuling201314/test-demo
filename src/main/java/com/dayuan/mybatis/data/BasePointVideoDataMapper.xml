<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dayuan.mapper.data.BasePointVideoDataMapper">
    <resultMap id="BaseResultMap" type="com.dayuan.bean.data.BasePouintVideoData">
        <result property="id" column="id"/>
        <result property="src" column="src"/>
        <result property="userId" column="create_by"/>
        <result property="state" column="state"/>
        <result property="remark" column="remark"/>
        <result property="uptime" column="update_date"/>
        <result property="title" column="title"/>
        <result property="fileSize" column="file_size"/>
        <result property="videoType" column="video_type"/>
    </resultMap>

    <!-- 页面显示,使用模型对象 -->
    <select id="loadDatagrid" resultMap="BaseResultMap"
            parameterType="Object">
        SELECT
            id,
            src,
            title,
            state,
            remark,
            ifnull(update_date, create_date) AS update_date,
            file_size,
            video_type,
            create_by
        FROM
            video_data
        WHERE delete_flag = 0
        LIMIT #{rowOffset}, #{pageSize}
    </select>

    <!-- 查询出总页数 -->
    <select id="getRowTotal" resultType="java.lang.Integer"
            parameterType="Object">
        SELECT count(1) AS rowTotal
        FROM video_data
        WHERE delete_flag = 0
    </select>
    <select id="selectSrcById" resultType="java.lang.String">
        SELECT src
        FROM
            video_data
        WHERE id = #{id} AND delete_flag = 0

    </select>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap">
        SELECT
            id,
            src,
            title,
            remark,
            video_type,
            state
        FROM
            video_data
        WHERE id = #{id} AND delete_flag = 0
    </select>
    <select id="selectTitleById" resultType="java.lang.String">
        SELECT title
        FROM
            video_data
        WHERE id = #{id}
    </select>

    <insert id="insert">
        INSERT INTO
            video_data (src, title, state, remark, create_by, file_size, video_type, create_date)
        VALUES
            (#{src,jdbcType=VARCHAR}, #{title,jdbcType=VARCHAR}, #{state,jdbcType=INTEGER}, #{remark,jdbcType=VARCHAR},
             #{userId,jdbcType=VARCHAR}, #{fileSize,jdbcType=DOUBLE}, #{videoType,jdbcType=INTEGER}, #{uptime,jdbcType=TIMESTAMP})
    </insert>
    <update id="updateByPrimaryKey">
        UPDATE
            video_data
        SET
            src         = #{src,jdbcType=VARCHAR},
            title       = #{title,jdbcType=VARCHAR},
            state       = #{state,jdbcType=INTEGER},
            remark      = #{remark,jdbcType=VARCHAR},
            video_type  = #{videoType,jdbcType=DOUBLE},
            file_size   = #{fileSize,jdbcType=DOUBLE},
            update_by   = #{updateBy,jdbcType=VARCHAR},
            update_date = #{updateDate,jdbcType=TIMESTAMP}
        WHERE id = #{id,jdbcType=BIGINT}
    </update>

    <update id="updateByPrimaryKeySelective">
        UPDATE
        video_data
        SET
        <if test="title != null and title != ''">
            title = #{title,jdbcType=VARCHAR},
        </if>
        video_type = #{videoType,jdbcType=DOUBLE},
        state = #{state,jdbcType=INTEGER},
        remark = #{remark,jdbcType=VARCHAR},
        update_by = #{updateBy,jdbcType=VARCHAR},
        update_date = #{updateDate,jdbcType=TIMESTAMP}
        WHERE id = #{id,jdbcType=BIGINT}
    </update>

    <!-- 删除和批量删除 -->
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        UPDATE video_data
        set delete_flag = 1
        where id in
        <foreach collection="array" item="ids" index="index" open="("
                 close=")" separator=",">
            #{ids}
        </foreach>
    </delete>
    <!--东营可视化大屏：查询所有的mp4学习视频-->
    <select id="queryAllStudyVideo"  resultMap="BaseResultMap">
        select * from video_data where delete_flag=0 and state=1 and src LIKE CONCAT('%','.mp4')
    </select>
</mapper>