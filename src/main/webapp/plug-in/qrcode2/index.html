<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">
  <head>
    <title>Cross-Browser QRCode generator for Javascript</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="qrcode.js"></script>
  </head>
  <body>
    <center>
        文本：<input id="input1" type="text" value="http://" /><br>
        LOGO：<img id="img" style="width: 25px; height: 25px;">
        <input id="input2" type="file" accept="image/*">(建议上传.jpg文件)
        <div id="qrcodeCanvas"></div>
    </center>
 <script type="text/javascript">
    //logo地址
    var defaultImgSrc = "default.jpg";
    $(function(){
        $("#img").attr("src", defaultImgSrc);
        myQrcode();
    });

    //修改文本
    $(document).on("change", "#input1", function() {
        myQrcode();
    });

    //修改logo
    $(document).on("change", "#input2", function() {
        var files = $('#input2').prop('files');//获取到文件列表
        var reader = new FileReader();
        reader.readAsArrayBuffer(files[0]);
        reader.onload = function (event) {
            var blob = new Blob([event.target.result]);
            window.URL = window.URL || window.webkitURL;
            defaultImgSrc = window.URL.createObjectURL(blob);
            $("#img").attr("src", defaultImgSrc);
            myQrcode();
        }
    });

    //生成二维码
    function myQrcode() {
        $("#qrcodeCanvas").html("");
        $("#qrcodeCanvas").qrcode({
             render : "canvas",    
             text : $("#input1").val(), 
             width : "100", 
             height : "100", 
             background : "#ffffff", 
             foreground : "#000000",
             src: defaultImgSrc
         });
    }
 </script>
  </body>
</html>
